# largely borrowed from https://github.com/leonardt/fault/blob/master/.travis.yml

matrix:
  include:
  - os: linux
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        packages:
        - g++-7
        - libgmp-dev
        - libmpfr-dev
        - libmpc-dev
        - verilator
    env:
    - CC=gcc-7
    - CXX=g++-7
# osx has a problem with python 3.7, could fix it by using conda like fault does
#  - os: osx
#    osx_image: xcode10.2
#    addons:
#      homebrew:
#        packages:
#          - verilator

language: python
python: 3.7

install: 
    - ./install_coreir.sh
    - pip install -r requirements.txt
    - pip install pytest
    - pip install -e .
    - wget http://mirrors.kernel.org/ubuntu/pool/universe/n/ngspice/ngspice_30.2-1_amd64.deb
    - sudo dpkg -i ngspice_30.2-1_amd64.deb || sudo apt-get -f install

script:
    - pytest

notifications:
    email: false

